// کتابخانه تبدیل تاریخ شمسی به میلادی - نسخه ساده و دقیق
class PersianDate {
    constructor() {
        this.persianMonths = [
            'فروردین', 'اردیبهشت', 'خرداد', 'تیر', 'مرداد', 'شهریور',
            'مهر', 'آبان', 'آذر', 'دی', 'بهمن', 'اسفند'
        ];
        
        this.gregorianMonths = [
            'January', 'February', 'March', 'April', 'May', 'June',
            'July', 'August', 'September', 'October', 'November', 'December'
        ];
    }

    // تبدیل تاریخ شمسی به میلادی با فرمول دقیق جوليان
    shamsiToMiladi(jy, jm, jd) {
        let gy, gm, gd;
        jy += 1595;
        let days = -355668 + (365 * jy) + (Math.floor(jy / 33) * 8) + Math.floor(((jy % 33) + 3) / 4) + jd;
        if (jm < 7) {
            days += (jm - 1) * 31;
        } else {
            days += ((jm - 7) * 30) + 186;
        }

        gy = 400 * Math.floor(days / 146097);
        days %= 146097;

        let leap = true;
        if (days >= 36525) {
            days--;
            gy += 100 * Math.floor(days / 36524);
            days %= 36524;
            if (days >= 365) {
                days++;
            }
            leap = false;
        }

        gy += 4 * Math.floor(days / 1461);
        days %= 1461;

        if (days >= 366) {
            leap = false;
            days--;
            gy += Math.floor(days / 365);
            days = days % 365;
        }

        gd = days + 1;

        const sal_a = [0, 31, (leap ? 29 : 28), 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
        
        for (gm = 0; gm < 13; gm++) {
            let v = sal_a[gm];
            if (gd <= v) break;
            gd -= v;
        }

        return { year: gy, month: gm, day: gd };
    }

    // تبدیل تاریخ میلادی به شمسی
    miladiToShamsi(gy, gm, gd) {
        const g_d_m = [0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334];
        
        let jy = (gy <= 1600) ? 0 : 979;
        gy -= (gy <= 1600) ? 621 : 1600;
        
        let gy2 = (gm > 2) ? (gy + 1) : gy;
        let days = (365 * gy) + (Math.floor((gy2 + 3) / 4)) - (Math.floor((gy2 + 99) / 100)) + 
                   (Math.floor((gy2 + 399) / 400)) - 80 + gd + g_d_m[gm - 1];
        
        jy += 33 * Math.floor(days / 12053);
        days %= 12053;
        
        jy += 4 * Math.floor(days / 1461);
        days %= 1461;
        
        if (days > 365) {
            jy += Math.floor((days - 1) / 365);
            days = (days - 1) % 365;
        }
        
        let jm, jd;
        if (days < 186) {
            jm = 1 + Math.floor(days / 31);
            jd = 1 + (days % 31);
        } else {
            jm = 7 + Math.floor((days - 186) / 30);
            jd = 1 + ((days - 186) % 30);
        }
        
        return { year: jy, month: jm, day: jd };
    }

    // محاسبه تعداد روزهای گذشته از آغاز تقویم شمسی
    shamsiDaysSinceEpoch(year, month, day) {
        let totalDays = 0;
        
        // اضافه کردن روزهای سال‌های گذشته
        for (let y = 1; y < year; y++) {
            totalDays += this.isPersianLeapYear(y) ? 366 : 365;
        }
        
        // اضافه کردن روزهای ماه‌های گذشته در سال جاری
        for (let m = 1; m < month; m++) {
            totalDays += this.getPersianMonthDays(year, m);
        }
        
        // اضافه کردن روزهای ماه جاری
        totalDays += day - 1;
        
        return totalDays;
    }

    // تبدیل تعداد روز به تاریخ شمسی
    daysToPersianDate(totalDays) {
        let year = 1;
        let month = 1;
        let day = 1;
        
        // پیدا کردن سال
        while (true) {
            let yearDays = this.isPersianLeapYear(year) ? 366 : 365;
            if (totalDays < yearDays) break;
            totalDays -= yearDays;
            year++;
        }
        
        // پیدا کردن ماه
        while (true) {
            let monthDays = this.getPersianMonthDays(year, month);
            if (totalDays < monthDays) break;
            totalDays -= monthDays;
            month++;
        }
        
        // روز
        day = totalDays + 1;
        
        return { year, month, day };
    }

    // بررسی سال کبیسه شمسی - الگوریتم دقیق
    isPersianLeapYear(year) {
        let breaks = [
            -14, 3, 13, 84, 111, 181, 210, 342, 377, 
            403, 434, 465, 496, 528, 559, 590, 621, 
            683, 714, 745, 776, 808, 839, 870, 901, 
            932, 963, 994, 1025, 1056, 1088, 1119, 
            1150, 1181, 1212, 1243, 1274, 1305, 1337, 
            1368, 1399, 1430, 1461, 1492, 1523, 1554, 
            1585, 1616, 1648, 1679, 1710, 1741, 1772, 
            1803, 1834, 1865, 1896, 1928, 1959, 1990, 
            2021, 2052, 2083, 2114, 2145, 2176, 2207, 
            2238, 2270, 2301, 2332, 2363, 2394, 2425, 
            2456, 2487, 2518, 2549, 2580, 2612, 2643, 
            2674, 2705, 2736, 2767, 2798, 2829, 2860, 
            2891, 2922, 2953, 2984, 3016, 3047, 3078, 
            3109, 3140, 3171, 3202, 3233, 3264, 3295, 
            3326, 3357, 3388, 3420, 3451, 3482, 3513, 
            3544, 3575, 3606, 3637, 3668, 3699, 3730, 
            3761, 3792, 3823, 3854, 3886, 3917, 3948, 
            3979, 4010, 4041, 4072, 4103, 4134, 4165, 
            4196, 4227, 4258, 4289, 4320, 4351, 4382, 
            4413, 4444, 4475, 4506, 4537, 4568, 4599, 
            4630, 4661, 4692, 4723, 4754, 4785, 4816, 
            4847, 4878, 4909, 4940, 4971, 5002, 5033, 
            5064, 5095, 5126, 5157, 5188, 5219, 5250, 
            5281, 5312, 5343, 5374, 5405, 5436, 5467, 
            5498, 5529, 5560, 5591, 5622, 5653, 5684, 
            5715, 5746, 5777, 5808, 5839, 5870, 5901, 
            5932, 5963, 5994, 6025, 6056, 6087, 6118, 
            6149, 6180, 6211, 6242, 6273, 6304, 6335, 
            6366, 6397, 6428, 6459, 6490, 6521, 6552, 
            6583, 6614, 6645, 6676, 6707, 6738, 6769, 
            6800, 6831, 6862, 6893, 6924, 6955, 6986, 
            7017, 7048, 7079, 7110, 7141, 7172, 7203, 
            7234, 7265, 7296, 7327, 7358, 7389, 7420, 
            7451, 7482, 7513, 7544, 7575, 7606, 7637, 
            7668, 7699, 7730, 7761, 7792, 7823, 7854, 
            7885, 7916, 7947, 7978, 8009, 8040, 8071, 
            8102, 8133, 8164, 8195, 8226, 8257, 8288, 
            8319, 8350, 8381, 8412, 8443, 8474, 8505, 
            8536, 8567, 8598, 8629, 8660, 8691, 8722, 
            8753, 8784, 8815, 8846, 8877, 8908, 8939, 
            8970, 9001, 9032, 9063, 9094, 9125, 9156, 
            9187, 9218, 9249, 9280, 9311, 9342, 9373, 
            9404, 9435, 9466, 9497, 9528, 9559, 9590, 
            9621, 9652, 9683, 9714, 9745, 9776, 9807, 
            9838, 9869, 9900, 9931, 9962, 9993, 10024, 
            10055, 10086, 10117, 10148, 10179, 10210, 
            10241, 10272, 10303, 10334, 10365, 10396, 
            10427, 10458, 10489, 10520, 10551, 10582, 
            10613, 10644, 10675, 10706, 10737, 10768, 
            10799, 10830, 10861, 10892, 10923, 10954, 
            10985, 11016, 11047, 11078, 11109, 11140, 
            11171, 11202, 11233, 11264, 11295, 11326, 
            11357, 11388, 11419, 11450, 11481, 11512, 
            11543, 11574, 11605, 11636, 11667, 11698, 
            11729, 11760, 11791, 11822, 11853, 11884, 
            11915, 11946, 11977, 12008, 12039, 12070, 
            12101, 12132, 12163, 12194, 12225, 12256, 
            12287, 12318, 12349, 12380, 12411, 12442, 
            12473, 12504, 12535, 12566, 12597, 12628, 
            12659, 12690, 12721, 12752, 12783, 12814, 
            12845, 12876, 12907, 12938, 12969, 13000, 
            13031, 13062, 13093, 13124, 13155, 13186, 
            13217, 13248, 13279, 13310, 13341, 13372, 
            13403, 13434, 13465, 13496, 13527, 13558, 
            13589, 13620, 13651, 13682, 13713, 13744, 
            13775, 13806, 13837, 13868, 13899, 13930, 
            13961, 13992, 14023, 14054, 14085, 14116, 
            14147, 14178, 14209, 14240, 14271, 14302, 
            14333, 14364, 14395, 14426, 14457, 14488, 
            14519, 14550, 14581, 14612, 14643, 14674, 
            14705, 14736, 14767, 14798, 14829, 14860, 
            14891, 14922, 14953, 14984, 15015, 15046, 
            15077, 15108, 15139, 15170, 15201, 15232, 
            15263, 15294, 15325, 15356, 15387, 15418, 
            15449, 15480, 15511, 15542, 15573, 15604, 
            15635, 15666, 15697, 15728, 15759, 15790, 
            15821, 15852, 15883, 15914, 15945, 15976, 
            16007, 16038, 16069, 16100, 16131, 16162, 
            16193, 16224, 16255, 16286, 16317, 16348, 
            16379, 16410, 16441, 16472, 16503, 16534, 
            16565, 16596, 16627, 16658, 16689, 16720, 
            16751, 16782, 16813, 16844, 16875, 16906, 
            16937, 16968, 16999, 17030, 17061, 17092, 
            17123, 17154, 17185, 17216, 17247, 17278, 
            17309, 17340, 17371, 17402, 17433, 17464, 
            17495, 17526, 17557, 17588, 17619, 17650, 
            17681, 17712, 17743, 17774, 17805, 17836, 
            17867, 17898, 17929, 17960, 17991, 18022, 
            18053, 18084, 18115, 18146, 18177, 18208, 
            18239, 18270, 18301, 18332, 18363, 18394, 
            18425, 18456, 18487, 18518, 18549, 18580, 
            18611, 18642, 18673, 18704, 18735, 18766, 
            18797, 18828, 18859, 18890, 18921, 18952, 
            18983, 19014, 19045, 19076, 19107, 19138, 
            19169, 19200, 19231, 19262, 19293, 19324, 
            19355, 19386, 19417, 19448, 19479, 19510, 
            19541, 19572, 19603, 19634, 19665, 19696, 
            19727, 19758, 19789, 19820, 19851, 19882, 
            19913, 19944, 19975, 20006, 20037, 20068, 
            20099, 20130, 20161, 20192, 20223, 20254, 
            20285, 20316, 20347, 20378, 20409, 20440, 
            20471, 20502, 20533, 20564, 20595, 20626, 
            20657, 20688, 20719, 20750, 20781, 20812, 
            20843, 20874, 20905, 20936, 20967, 20998, 
            21029, 21060, 21091, 21122, 21153, 21184, 
            21215, 21246, 21277, 21308, 21339, 21370, 
            21401, 21432, 21463, 21494, 21525, 21556, 
            21587, 21618, 21649, 21680, 21711, 21742, 
            21773, 21804, 21835, 21866, 21897, 21928, 
            21959, 21990, 22021, 22052, 22083, 22114, 
            22145, 22176, 22207, 22238, 22269, 22300, 
            22331, 22362, 22393, 22424, 22455, 22486, 
            22517, 22548, 22579, 22610, 22641, 22672, 
            22703, 22734, 22765, 22796, 22827, 22858, 
            22889, 22920, 22951, 22982, 23013, 23044, 
            23075, 23106, 23137, 23168, 23199, 23230, 
            23261, 23292, 23323, 23354, 23385, 23416, 
            23447, 23478, 23509, 23540, 23571, 23602, 
            23633, 23664, 23695, 23726, 23757, 23788, 
            23819, 23850, 23881, 23912, 23943, 23974, 
            24005, 24036, 24067, 24098, 24129, 24160, 
            24191, 24222, 24253, 24284, 24315, 24346, 
            24377, 24408, 24439, 24470, 24501, 24532, 
            24563, 24594, 24625, 24656, 24687, 24718, 
            24749, 24780, 24811, 24842, 24873, 24904, 
            24935, 24966, 24997, 25028, 25059, 25090, 
            25121, 25152, 25183, 25214, 25245, 25276, 
            25307, 25338, 25369, 25400, 25431, 25462, 
            25493, 25524, 25555, 25586, 25617, 25648, 
            25679, 25710, 25741, 25772, 25803, 25834, 
            25865, 25896, 25927, 25958, 25989, 26020, 
            26051, 26082, 26113, 26144, 26175, 26206, 
            26237, 26268, 26299, 26330, 26361, 26392, 
            26423, 26454, 26485, 26516, 26547, 26578, 
            26609, 26640, 26671, 26702, 26733, 26764, 
            26795, 26826, 26857, 26888, 26919, 26950, 
            26981, 27012, 27043, 27074, 27105, 27136, 
            27167, 27198, 27229, 27260, 27291, 27322, 
            27353, 27384, 27415, 27446, 27477, 27508, 
            27539, 27570, 27601, 27632, 27663, 27694, 
            27725, 27756, 27787, 27818, 27849, 27880, 
            27911, 27942, 27973, 28004, 28035, 28066, 
            28097, 28128, 28159, 28190, 28221, 28252, 
            28283, 28314, 28345, 28376, 28407, 28438, 
            28469, 28500, 28531, 28562, 28593, 28624, 
            28655, 28686, 28717, 28748, 28779, 28810, 
            28841, 28872, 28903, 28934, 28965, 28996, 
            29027, 29058, 29089, 29120, 29151, 29182, 
            29213, 29244, 29275, 29306, 29337, 29368, 
            29399, 29430, 29461, 29492, 29523, 29554, 
            29585, 29616, 29647, 29678, 29709, 29740, 
            29771, 29802, 29833, 29864, 29895, 29926, 
            29957, 29988, 30019, 30050, 30081, 30112, 
            30143, 30174, 30205, 30236, 30267, 30298, 
            30329, 30360, 30391, 30422, 30453, 30484, 
            30515, 30546, 30577, 30608, 30639, 30670, 
            30701, 30732, 30763, 30794, 30825, 30856, 
            30887, 30918, 30949, 30980, 31011, 31042, 
            31073, 31104, 31135, 31166, 31197, 31228, 
            31259, 31290, 31321, 31352, 31383, 31414, 
            31445, 31476, 31507, 31538, 31569, 31600, 
            31631, 31662, 31693, 31724, 31755, 31786, 
            31817, 31848, 31879, 31910, 31941, 31972, 
            32003, 32034, 32065, 32096, 32127, 32158, 
            32189, 32220, 32251, 32282, 32313, 32344, 
            32375, 32406, 32437, 32468, 32499, 32530, 
            32561, 32592, 32623, 32654, 32685, 32716, 
            32747, 32778, 32809, 32840, 32871, 32902, 
            32933, 32964, 32995, 33026, 33057, 33088, 
            33119, 33150, 33181, 33212, 33243, 33274, 
            33305, 33336, 33367, 33398, 33429, 33460, 
            33491, 33522, 33553, 33584, 33615, 33646, 
            33677, 33708, 33739, 33770, 33801, 33832, 
            33863, 33894, 33925, 33956, 33987, 34018, 
            34049, 34080, 34111, 34142, 34173, 34204, 
            34235, 34266, 34297, 34328, 34359, 34390, 
            34421, 34452, 34483, 34514, 34545, 34576, 
            34607, 34638, 34669, 34700, 34731, 34762, 
            34793, 34824, 34855, 34886, 34917, 34948, 
            34979, 35010, 35041, 35072, 35103, 35134, 
            35165, 35196, 35227, 35258, 35289, 35320, 
            35351, 35382, 35413, 35444, 35475, 35506, 
            35537, 35568, 35599, 35630, 35661, 35692, 
            35723, 35754, 35785, 35816, 35847, 35878, 
            35909, 35940, 35971, 36002, 36033, 36064, 
            36095, 36126, 36157, 36188, 36219, 36250, 
            36281, 36312, 36343, 36374, 36405, 36436, 
            36467, 36498, 36529, 36560, 36591, 36622, 
            36653, 36684, 36715, 36746, 36777, 36808, 
            36839, 36870, 36901, 36932, 36963, 36994, 
            37025, 37056, 37087, 37118, 37149, 37180, 
            37211, 37242, 37273, 37304, 37335, 37366, 
            37397, 37428, 37459, 37490, 37521, 37552, 
            37583, 37614, 37645, 37676, 37707, 37738, 
            37769, 37800, 37831, 37862, 37893, 37924, 
            37955, 37986, 38017, 38048, 38079, 38110, 
            38141, 38172, 38203, 38234, 38265, 38296, 
            38327, 38358, 38389, 38420, 38451, 38482, 
            38513, 38544, 38575, 38606, 38637, 38668, 
            38699, 38730, 38761, 38792, 38823, 38854, 
            38885, 38916, 38947, 38978, 39009, 39040, 
            39071, 39102, 39133, 39164, 39195, 39226, 
            39257, 39288, 39319, 39350, 39381, 39412, 
            39443, 39474, 39505, 39536, 39567, 39598, 
            39629, 39660, 39691, 39722, 39753, 39784, 
            39815, 39846, 39877, 39908, 39939, 39970, 
            40001, 40032, 40063, 40094, 40125, 40156, 
            40187, 40218, 40249, 40280, 40311, 40342, 
            40373, 40404, 40435, 40466, 40497, 40528, 
            40559, 40590, 40621, 40652, 40683, 40714, 
            40745, 40776, 40807, 40838, 40869, 40900, 
            40931, 40962, 40993, 41024, 41055, 41086, 
            41117, 41148, 41179, 41210, 41241, 41272, 
            41303, 41334, 41365, 41396, 41427, 41458, 
            41489, 41520, 41551, 41582, 41613, 41644, 
            41675, 41706, 41737, 41768, 41799, 41830, 
            41861, 41892, 41923, 41954, 41985, 42016, 
            42047, 42078, 42109, 42140, 42171, 42202, 
            42233, 42264, 42295, 42326, 42357, 42388, 
            42419, 42450, 42481, 42512, 42543, 42574, 
            42605, 42636, 42667, 42698, 42729, 42760, 
            42791, 42822, 42853, 42884, 42915, 42946, 
            42977, 43008, 43039, 43070, 43101, 43132, 
            43163, 43194, 43225, 43256, 43287, 43318, 
            43349, 43380, 43411, 43442, 43473, 43504, 
            43535, 43566, 43597, 43628, 43659, 43690, 
            43721, 43752, 43783, 43814, 43845, 43876, 
            43907, 43938, 43969, 44000, 44031, 44062, 
            44093, 44124, 44155, 44186, 44217, 44248, 
            44279, 44310, 44341, 44372, 44403, 44434, 
            44465, 44496, 44527, 44558, 44589, 44620, 
            44651, 44682, 44713, 44744, 44775, 44806, 
            44837, 44868, 44899, 44930, 44961, 44992, 
            45023, 45054, 45085, 45116, 45147, 45178, 
            45209, 45240, 45271, 45302, 45333, 45364, 
            45395, 45426, 45457, 45488, 45519, 45550, 
            45581, 45612, 45643, 45674, 45705, 45736, 
            45767, 45798, 45829, 45860, 45891, 45922, 
            45953, 45984, 46015, 46046, 46077, 46108, 
            46139, 46170, 46201, 46232, 46263, 46294, 
            46325, 46356, 46387, 46418, 46449, 46480, 
            46511, 46542, 46573, 46604, 46635, 46666, 
            46697, 46728, 46759, 46790, 46821, 46852, 
            46883, 46914, 46945, 46976, 47007, 47038, 
            47069, 47100, 47131, 47162, 47193, 47224, 
            47255, 47286, 47317, 47348, 47379, 47410, 
            47441, 47472, 47503, 47534, 47565, 47596, 
            47627, 47658, 47689, 47720, 47751, 47782, 
            47813, 47844, 47875, 47906, 47937, 47968, 
            47999, 48030, 48061, 48092, 48123, 48154, 
            48185, 48216, 48247, 48278, 48309, 48340, 
            48371, 48402, 48433, 48464, 48495, 48526, 
            48557, 48588, 48619, 48650, 48681, 48712, 
            48743, 48774, 48805, 48836, 48867, 48898, 
            48929, 48960, 48991, 49022, 49053, 49084, 
            49115, 49146, 49177, 49208, 49239, 49270, 
            49301, 49332, 49363, 49394, 49425, 49456, 
            49487, 49518, 49549, 49580, 49611, 49642, 
            49673, 49704, 49735, 49766, 49797, 49828, 
            49859, 49890, 49921, 49952, 49983, 50014, 
            50045, 50076, 50107, 50138, 50169, 50200, 
            50231, 50262, 50293, 50324, 50355, 50386, 
            50417, 50448, 50479, 50510, 50541, 50572, 
            50603, 50634, 50665, 50696, 50727, 50758, 
            50789, 50820, 50851, 50882, 50913, 50944, 
            50975, 51006, 51037, 51068, 51099, 51130, 
            51161, 51192, 51223, 51254, 51285, 51316, 
            51347, 51378, 51409, 51440, 51471, 51502, 
            51533, 51564, 51595, 51626, 51657, 51688, 
            51719, 51750, 51781, 51812, 51843, 51874, 
            51905, 51936, 51967, 51998, 52029, 52060, 
            52091, 52122, 52153, 52184, 52215, 52246, 
            52277, 52308, 52339, 52370, 52401, 52432, 
            52463, 52494, 52525, 52556, 52587, 52618, 
            52649, 52680, 52711, 52742, 52773, 52804, 
            52835, 52866, 52897, 52928, 52959, 52990, 
            53021, 53052, 53083, 53114, 53145, 53176, 
            53207, 53238, 53269, 53300, 53331, 53362, 
            53393, 53424, 53455, 53486, 53517, 53548, 
            53579, 53610, 53641, 53672, 53703, 53734, 
            53765, 53796, 53827, 53858, 53889, 53920, 
            53951, 53982, 54013, 54044, 54075, 54106, 
            54137, 54168, 54199, 54230, 54261, 54292, 
            54323, 54354, 54385, 54416, 54447, 54478, 
            54509, 54540, 54571, 54602, 54633, 54664, 
            54695, 54726, 54757, 54788, 54819, 54850, 
            54881, 54912, 54943, 54974, 55005, 55036, 
            55067, 55098, 55129, 55160, 55191, 55222, 
            55253, 55284, 55315, 55346, 55377, 55408, 
            55439, 55470, 55501, 55532, 55563, 55594, 
            55625, 55656, 55687, 55718, 55749, 55780, 
            55811, 55842, 55873, 55904, 55935, 55966, 
            55997, 56028, 56059, 56090, 56121, 56152, 
            56183, 56214, 56245, 56276, 56307, 56338, 
            56369, 56400, 56431, 56462, 56493, 56524, 
            56555, 56586, 56617, 56648, 56679, 56710, 
            56741, 56772, 56803, 56834, 56865, 56896, 
            56927, 56958, 56989, 57020, 57051, 57082, 
            57113, 57144, 57175, 57206, 57237, 57268, 
            57299, 57330, 57361, 57392, 57423, 57454, 
            57485, 57516, 57547, 57578, 57609, 57640, 
            57671, 57702, 57733, 57764, 57795, 57826, 
            57857, 57888, 57919, 57950, 57981, 58012, 
            58043, 58074, 58105, 58136, 58167, 58198, 
            58229, 58260, 58291, 58322, 58353, 58384, 
            58415, 58446, 58477, 58508, 58539, 58570, 
            58601, 58632, 58663, 58694, 58725, 58756, 
            58787, 58818, 58849, 58880, 58911, 58942, 
            58973, 59004, 59035, 59066, 59097, 59128, 
            59159, 59190, 59221, 59252, 59283, 59314, 
            59345, 59376, 59407, 59438, 59469, 59500, 
            59531, 59562, 59593, 59624, 59655, 59686, 
            59717, 59748, 59779, 59810, 59841, 59872, 
            59903, 59934, 59965, 59996, 60027, 60058, 
            60089, 60120, 60151, 60182, 60213, 60244, 
            60275, 60306, 60337, 60368, 60399, 60430, 
            60461, 60492, 60523, 60554, 60585, 60616, 
            60647, 60678, 60709, 60740, 60771, 60802, 
            60833, 60864, 60895, 60926, 60957, 60988, 
            61019, 61050, 61081, 61112, 61143, 61174, 
            61205, 61236, 61267, 61298, 61329, 61360, 
            61391, 61422, 61453, 61484, 61515, 61546, 
            61577, 61608, 61639, 61670, 61701, 61732, 
            61763, 61794, 61825, 61856, 61887, 61918, 
            61949, 61980, 62011, 62042, 62073, 62104, 
            62135, 62166, 62197, 62228, 62259, 62290, 
            62321, 62352, 62383, 62414, 62445, 62476, 
            62507, 62538, 62569, 62600, 62631, 62662, 
            62693, 62724, 62755, 62786, 62817, 62848, 
            62879, 62910, 62941, 62972, 63003, 63034, 
            63065, 63096, 63127, 63158, 63189, 63220, 
            63251, 63282, 63313, 63344, 63375, 63406, 
            63437, 63468, 63499, 63530, 63561, 63592, 
            63623, 63654, 63685, 63716, 63747, 63778, 
            63809, 63840, 63871, 63902, 63933, 63964, 
            63995, 64026, 64057, 64088, 64119, 64150, 
            64181, 64212, 64243, 64274, 64305, 64336, 
            64367, 64398, 64429, 64460, 64491, 64522, 
            64553, 64584, 64615, 64646, 64677, 64708, 
            64739, 64770, 64801, 64832, 64863, 64894, 
            64925, 64956, 64987, 65018, 65049, 65080, 
            65111, 65142, 65173, 65204, 65235, 65266, 
            65297, 65328, 65359, 65390, 65421, 65452, 
            65483, 65514, 65545, 65576, 65607, 65638, 
            65669, 65700, 65731, 65762, 65793, 65824, 
            65855, 65886, 65917, 65948, 65979, 66010, 
            66041, 66072, 66103, 66134, 66165, 66196, 
            66227, 66258, 66289, 66320, 66351, 66382, 
            66413, 66444, 66475, 66506, 66537, 66568, 
            66599, 66630, 66661, 66692, 66723, 66754, 
            66785, 66816, 66847, 66878, 66909, 66940, 
            66971, 67002, 67033, 67064, 67095, 67126, 
            67157, 67188, 67219, 67250, 67281, 67312, 
            67343, 67374, 67405, 67436, 67467, 67498, 
            67529, 67560, 67591, 67622, 67653, 67684, 
            67715, 67746, 67777, 67808, 67839, 67870, 
            67901, 67932, 67963, 67994, 68025, 68056, 
            68087, 68118, 68149, 68180, 68211, 68242, 
            68273, 68304, 68335, 68366, 68397, 68428, 
            68459, 68490, 68521, 68552, 68583, 68614, 
            68645, 68676, 68707, 68738, 68769, 68800, 
            68831, 68862, 68893, 68924, 68955, 68986, 
            69017, 69048, 69079, 69110, 69141, 69172, 
            69203, 69234, 69265, 69296, 69327, 69358, 
            69389, 69420, 69451, 69482, 69513, 69544, 
            69575, 69606, 69637, 69668, 69699, 69730, 
            69761, 69792, 69823, 69854, 69885, 69916, 
            69947, 69978, 70009, 70040, 70071, 70102, 
            70133, 70164, 70195, 70226, 70257, 70288, 
            70319, 70350, 70381, 70412, 70443, 70474, 
            70505, 70536, 70567, 70598, 70629, 70660, 
            70691, 70722, 70753, 70784, 70815, 70846, 
            70877, 70908, 70939, 70970, 71001, 71032, 
            71063, 71094, 71125, 71156, 71187, 71218, 
            71249, 71280, 71311, 71342, 71373, 71404, 
            71435, 71466, 71497, 71528, 71559, 71590, 
            71621, 71652, 71683, 71714, 71745, 71776, 
            71807, 71838, 71869, 71900, 71931, 71962, 
            71993, 72024, 72055, 72086, 72117, 72148, 
            72179, 72210, 72241, 72272, 72303, 72334, 
            72365, 72396, 72427, 72458, 72489, 72520, 
            72551, 72582, 72613, 72644, 72675, 72706, 
            72737, 72768, 72799, 72830, 72861, 72892, 
            72923, 72954, 72985, 73016, 73047, 73078, 
            73109, 73140, 73171, 73202, 73233, 73264, 
            73295, 73326, 73357, 73388, 73419, 73450, 
            73481, 73512, 73543, 73574, 73605, 73636, 
            73667, 73698, 73729, 73760, 73791, 73822, 
            73853, 73884, 73915, 73946, 73977, 74008, 
            74039, 74070, 74101, 74132, 74163, 74194, 
            74225, 74256, 74287, 74318, 74349, 74380, 
            74411, 74442, 74473, 74504, 74535, 74566, 
            74597, 74628, 74659, 74690, 74721, 74752, 
            74783, 74814, 74845, 74876, 74907, 74938, 
            74969, 75000, 75031, 75062, 75093, 75124, 
            75155, 75186, 75217, 75248, 75279, 75310, 
            75341, 75372, 75403, 75434, 75465, 75496, 
            75527, 75558, 75589, 75620, 75651, 75682, 
            75713, 75744, 75775, 75806, 75837, 75868, 
            75899, 75930, 75961, 75992, 76023, 76054, 
            76085, 76116, 76147, 76178, 76209, 76240, 
            76271, 76302, 76333, 76364, 76395, 76426, 
            76457, 76488, 76519, 76550, 76581, 76612, 
            76643, 76674, 76705, 76736, 76767, 76798, 
            76829, 76860, 76891, 76922, 76953, 76984, 
            77015, 77046, 77077, 77108, 77139, 77170, 
            77201, 77232, 77263, 77294, 77325, 77356, 
            77387, 77418, 77449, 77480, 77511, 77542, 
            77573, 77604, 77635, 77666, 77697, 77728, 
            77759, 77790, 77821, 77852, 77883, 77914, 
            77945, 77976, 78007, 78038, 78069, 78100, 
            78131, 78162, 78193, 78224, 78255, 78286, 
            78317, 78348, 78379, 78410, 78441, 78472, 
            78503, 78534, 78565, 78596, 78627, 78658, 
            78689, 78720, 78751, 78782, 78813, 78844, 
            78875, 78906, 78937, 78968, 78999, 79030, 
            79061, 79092, 79123, 79154, 79185, 79216, 
            79247, 79278, 79309, 79340, 79371, 79402, 
            79433, 79464, 79495, 79526, 79557, 79588, 
            79619, 79650, 79681, 79712, 79743, 79774, 
            79805, 79836, 79867, 79898, 79929, 79960, 
            79991, 80022, 80053, 80084, 80115, 80146, 
            80177, 80208, 80239, 80270, 80301, 80332, 
            80363, 80394, 80425, 80456, 80487, 80518, 
            80549, 80580, 80611, 80642, 80673, 80704, 
            80735, 80766, 80797, 80828, 80859, 80890, 
            80921, 80952, 80983, 81014, 81045, 81076, 
            81107, 81138, 81169, 81200, 81231, 81262, 
            81293, 81324, 81355, 81386, 81417, 81448, 
            81479, 81510, 81541, 81572, 81603, 81634, 
            81665, 81696, 81727, 81758, 81789, 81820, 
            81851, 81882, 81913, 81944, 81975, 82006, 
            82037, 82068, 82099, 82130, 82161, 82192, 
            82223, 82254, 82285, 82316, 82347, 82378, 
            82409, 82440, 82471, 82502, 82533, 82564, 
            82595, 82626, 82657, 82688, 82719, 82750, 
            82781, 82812, 82843, 82874, 82905, 82936, 
            82967, 82998, 83029, 83060, 83091, 83122, 
            83153, 83184, 83215, 83246, 83277, 83308, 
            83339, 83370, 83401, 83432, 83463, 83494, 
            83525, 83556, 83587, 83618, 83649, 83680, 
            83711, 83742, 83773, 83804, 83835, 83866, 
            83897, 83928, 83959, 83990, 84021, 84052, 
            84083, 84114, 84145, 84176, 84207, 84238, 
            84269, 84300, 84331, 84362, 84393, 84424, 
            84455, 84486, 84517, 84548, 84579, 84610, 
            84641, 84672, 84703, 84734, 84765, 84796, 
            84827, 84858, 84889, 84920, 84951, 84982, 
            85013, 85044, 85075, 85106, 85137, 85168, 
            85199, 85230, 85261, 85292, 85323, 85354, 
            85385, 85416, 85447, 85478, 85509, 85540, 
            85571, 85602, 85633, 85664, 85695, 85726, 
            85757, 85788, 85819, 85850, 85881, 85912, 
            85943, 85974, 86005, 86036, 86067, 86098, 
            86129, 86160, 86191, 86222, 86253, 86284, 
            86315, 86346, 86377, 86408, 86439, 86470, 
            86501, 86532, 86563, 86594, 86625, 86656, 
            86687, 86718, 86749, 86780, 86811, 86842, 
            86873, 86904, 86935, 86966, 86997, 87028, 
            87059, 87090, 87121, 87152, 87183, 87214, 
            87245, 87276, 87307, 87338, 87369, 87400, 
            87431, 87462, 87493, 87524, 87555, 87586, 
            87617, 87648, 87679, 87710, 87741, 87772, 
            87803, 87834, 87865, 87896, 87927, 87958, 
            87989, 88020, 88051, 88082, 88113, 88144, 
            88175, 88206, 88237, 88268, 88299, 88330, 
            88361, 88392, 88423, 88454, 88485, 88516, 
            88547, 88578, 88609, 88640, 88671, 88702, 
            88733, 88764, 88795, 88826, 88857, 88888, 
            88919, 88950, 88981, 89012, 89043, 89074, 
            89105, 89136, 89167, 89198, 89229, 89260, 
            89291, 89322, 89353, 89384, 89415, 89446, 
            89477, 89508, 89539, 89570, 89601, 89632, 
            89663, 89694, 89725, 89756, 89787, 89818, 
            89849, 89880, 89911, 89942, 89973, 90004, 
            90035, 90066, 90097, 90128, 90159, 90190, 
            90221, 90252, 90283, 90314, 90345, 90376, 
            90407, 90438, 90469, 90500, 90531, 90562, 
            90593, 90624, 90655, 90686, 90717, 90748, 
            90779, 90810, 90841, 90872, 90903, 90934, 
            90965, 90996, 91027, 91058, 91089, 91120, 
            91151, 91182, 91213, 91244, 91275, 91306, 
            91337, 91368, 91399, 91430, 91461, 91492, 
            91523, 91554, 91585, 91616, 91647, 91678, 
            91709, 91740, 91771, 91802, 91833, 91864, 
            91895, 91926, 91957, 91988, 92019, 92050, 
            92081, 92112, 92143, 92174, 92205, 92236, 
            92267, 92298, 92329, 92360, 92391, 92422, 
            92453, 92484, 92515, 92546, 92577, 92608, 
            92639, 92670, 92701, 92732, 92763, 92794, 
            92825, 92856, 92887, 92918, 92949, 92980, 
            93011, 93042, 93073, 93104, 93135, 93166, 
            93197, 93228, 93259, 93290, 93321, 93352, 
            93383, 93414, 93445, 93476, 93507, 93538, 
            93569, 93600, 93631, 93662, 93693, 93724, 
            93755, 93786, 93817, 93848, 93879, 93910, 
            93941, 93972, 94003, 94034, 94065, 94096, 
            94127, 94158, 94189, 94220, 94251, 94282, 
            94313, 94344, 94375, 94406, 94437, 94468, 
            94499, 94530, 94561, 94592, 94623, 94654, 
            94685, 94716, 94747, 94778, 94809, 94840, 
            94871, 94902, 94933, 94964, 94995, 95026, 
            95057, 95088, 95119, 95150, 95181, 95212, 
            95243, 95274, 95305, 95336, 95367, 95398, 
            95429, 95460, 95491, 95522, 95553, 95584, 
            95615, 95646, 95677, 95708, 95739, 95770, 
            95801, 95832, 95863, 95894, 95925, 95956, 
            95987, 96018, 96049, 96080, 96111, 96142, 
            96173, 96204, 96235, 96266, 96297, 96328, 
            96359, 96390, 96421, 96452, 96483, 96514, 
            96545, 96576, 96607, 96638, 96669, 96700, 
            96731, 96762, 96793, 96824, 96855, 96886, 
            96917, 96948, 96979, 97010, 97041, 97072, 
            97103, 97134, 97165, 97196, 97227, 97258, 
            97289, 97320, 97351, 97382, 97413, 97444, 
            97475, 97506, 97537, 97568, 97599, 97630, 
            97661, 97692, 97723, 97754, 97785, 97816, 
            97847, 97878, 97909, 97940, 97971, 98002, 
            98033, 98064, 98095, 98126, 98157, 98188, 
            98219, 98250, 98281, 98312, 98343, 98374, 
            98405, 98436, 98467, 98498, 98529, 98560, 
            98591, 98622, 98653, 98684, 98715, 98746, 
            98777, 98808, 98839, 98870, 98901, 98932, 
            98963, 98994, 99025, 99056, 99087, 99118, 
            99149, 99180, 99211, 99242, 99273, 99304, 
            99335, 99366, 99397, 99428, 99459, 99490, 
            99521, 99552, 99583, 99614, 99645, 99676, 
            99707, 99738, 99769, 99800, 99831, 99862, 
            99893, 99924, 99955, 99986, 100017, 100048, 
            100079, 100110, 100141, 100172, 100203
        ];
        
        let gy = year - breaks[0];
        let jyp = breaks[1];
        let jp = 0;
        
        for (let j = 1; j <= breaks.length - 1; j++) {
            let jm = breaks[j];
            let jump = jm - jyp;
            if (year < jm) break;
            jp += Math.floor(jump / 33) * 8 + Math.floor((jump % 33) / 4);
            jyp = jm;
        }
        
        if ((year - jyp) < 0) {
            jp -= Math.floor((jyp - year) / 33) * 8 + Math.floor(((jyp - year) % 33) / 4);
        } else {
            jp += Math.floor((year - jyp) / 33) * 8 + Math.floor(((year - jyp) % 33 + 3) / 4);
        }
        
        return jp % 8 === 0 || jp % 8 === 5;
    }

    // دریافت تعداد روزهای ماه شمسی
    getPersianMonthDays(year, month) {
        if (month <= 6) return 31;
        if (month <= 11) return 30;
        return this.isPersianLeapYear(year) ? 30 : 29;
    }

    // فرمت کردن تاریخ شمسی
    formatPersianDate(year, month, day) {
        return `${year}/${String(month).padStart(2, '0')}/${String(day).padStart(2, '0')}`;
    }

    // فرمت کردن تاریخ میلادی
    formatGregorianDate(year, month, day) {
        return `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
    }
}

// نمونه سازی کلاس
const persianDate = new PersianDate();